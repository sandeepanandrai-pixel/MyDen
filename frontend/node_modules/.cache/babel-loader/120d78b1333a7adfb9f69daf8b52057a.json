{"ast":null,"code":"```\nimport React, { useState, useEffect } from 'react';\nimport MarketChart from '../components/MarketChart';\nimport AssetCard from '../components/AssetCard';\nimport TransactionModal from '../components/TransactionModal';\nimport { Plus } from 'lucide-react';\nimport axios from 'axios';\n\nconst Dashboard = () => {\n    const [modalConfig, setModalConfig] = useState({ isOpen: false, symbol: '', price: 0, type: 'buy' });\n    const [portfolio, setPortfolio] = useState([]);\n    const [totalValue, setTotalValue] = useState(0);\n\n    // Mock Market Data (In real app, fetch from API)\n    const marketPrices = {\n        'AAPL': 175.43,\n        'TSLA': 240.50,\n        'BTC': 42100.00,\n        'USDC': 1.00\n    };\n\n    useEffect(() => {\n        fetchPortfolio();\n    }, []);\n\n    const fetchPortfolio = async () => {\n        try {\n            const res = await axios.get('http://localhost:5000/api/portfolio');\n            setPortfolio(res.data);\n            \n            // Calculate Total Value\n            let total = 0;\n            res.data.forEach(item => {\n                const currentPrice = marketPrices[item.symbol] || item.averageBuyPrice; // Fallback to buy price if live price not found\n                total += item.quantity * currentPrice;\n            });\n            setTotalValue(total);\n\n        } catch (err) {\n            console.error(\"Failed to fetch portfolio\", err);\n        }\n    };\n\n    const openModal = (symbol, price, type = 'buy') => {\n        setModalConfig({ isOpen: true, symbol, price, type });\n    };\n\n    const closeModal = () => {\n        setModalConfig(prev => ({ ...prev, isOpen: false }));\n    };\n\n  return (\n    <div className=\"space-y-6\">\n      <TransactionModal \n        isOpen={modalConfig.isOpen} \n        onClose={closeModal}\n        symbol={modalConfig.symbol}\n        currentPrice={modalConfig.price}\n        type={modalConfig.type}\n      />\n\n      {/* Welcome Section */}\n      <div className=\"flex justify-between items-end\">\n        <div>\n          <h1 className=\"text-3xl font-extrabold text-white\">Welcome back, Trader</h1>\n          <p className=\"text-slate-400 mt-1\">Here is what's happening in the market today.</p>\n        </div>\n        <button onClick={() => openModal('USDC', 1, 'buy')} className=\"flex items-center space-x-2 bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 rounded-lg font-medium transition-colors shadow-lg shadow-blue-600/20\">\n            <Plus size={18} />\n            <span>Deposit Funds</span>\n        </button>\n      </div>\n\n      {/* Main Grid */}\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\n        \n        {/* Left Column (Chart + Stats) */}\n        <div className=\"lg:col-span-2 space-y-6\">\n          <MarketChart />\n          \n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n             <div className=\"bg-slate-800 p-6 rounded-xl border border-slate-700\">\n                <p className=\"text-slate-400 text-sm font-medium\">Total Portfolio Value</p>\n                <p className=\"text-3xl font-bold text-white mt-2\">${totalValue.toLocaleString()}</p>\n                <div className=\"mt-4 flex items-center text-green-400 text-sm\">\n                    <span className=\"bg-green-400/10 px-2 py-1 rounded\">+12.5%</span> \n                    <span className=\"ml-2 text-slate-400\">vs invested capital</span>\n                </div>\n             </div>\n             <div className=\"bg-slate-800 p-6 rounded-xl border border-slate-700\">\n                <p className=\"text-slate-400 text-sm font-medium\">Your Holdings</p>\n                <div className=\"mt-2 space-y-2\">\n                    {portfolio.length === 0 ? (\n                        <p className=\"text-slate-500 text-sm\">No assets owned yet.</p>\n                    ) : (\n                        portfolio.map(asset => (\n                            <div key={asset._id} className=\"flex justify-between text-sm\">\n                                <span className=\"text-white font-medium\">{asset.symbol}</span>\n                                <span className=\"text-slate-400\">{asset.quantity} units</span>\n                            </div>\n                        ))\n                    )}\n                </div>\n             </div>\n          </div>\n        </div>\n\n        {/* Right Column (Watchlist/Assets) */}\n        <div className=\"space-y-4\">\n            <div className=\"flex justify-between items-center mb-2\">\n                <h3 className=\"text-xl font-bold text-white\">Market Watch</h3>\n                <button className=\"text-blue-500 text-sm font-medium hover:text-blue-400 transition-colors\">View All</button>\n            </div>\n            \n            {/* Mock Market Data Cards */}\n            <div onClick={() => openModal('AAPL', 175.43, 'buy')}><AssetCard symbol=\"AAPL\" name=\"Apple Inc.\" price={175.43} change={2.34} changePercent={1.25} isPositive={true} /></div>\n            <div onClick={() => openModal('TSLA', 240.50, 'buy')}><AssetCard symbol=\"TSLA\" name=\"Tesla, Inc.\" price={240.50} change={-5.20} changePercent={-2.15} isPositive={false} /></div>\n            <div onClick={() => openModal('BTC', 42100.00, 'buy')}><AssetCard symbol=\"BTC\" name=\"Bitcoin\" price={42100.00} change={1200.00} changePercent={3.45} isPositive={true} /></div>\n            \n            <div className=\"pt-4 border-t border-slate-800\">\n                 <h3 className=\"text-sm font-bold text-slate-400 mb-2\">ACTIONS</h3>\n                 <div className=\"grid grid-cols-2 gap-2\">\n                     <button onClick={() => openModal('AAPL', 175.43, 'sell')} className=\"bg-slate-800 text-slate-300 py-2 rounded hover:bg-slate-700 text-sm\">Sell AAPL</button>\n                     <button onClick={() => openModal('TSLA', 240.50, 'sell')} className=\"bg-slate-800 text-slate-300 py-2 rounded hover:bg-slate-700 text-sm\">Sell TSLA</button>\n                 </div>\n            </div>\n        </div>\n      </div>\n    </div>\n  );\n};\n\nexport default Dashboard;\n```;","map":{"version":3,"names":["totalValue","toLocaleString"],"sources":["C:/projects/MyDen/my-fullstack-app/frontend/src/pages/Dashboard.jsx"],"sourcesContent":["```\r\nimport React, { useState, useEffect } from 'react';\r\nimport MarketChart from '../components/MarketChart';\r\nimport AssetCard from '../components/AssetCard';\r\nimport TransactionModal from '../components/TransactionModal';\r\nimport { Plus } from 'lucide-react';\r\nimport axios from 'axios';\r\n\r\nconst Dashboard = () => {\r\n    const [modalConfig, setModalConfig] = useState({ isOpen: false, symbol: '', price: 0, type: 'buy' });\r\n    const [portfolio, setPortfolio] = useState([]);\r\n    const [totalValue, setTotalValue] = useState(0);\r\n\r\n    // Mock Market Data (In real app, fetch from API)\r\n    const marketPrices = {\r\n        'AAPL': 175.43,\r\n        'TSLA': 240.50,\r\n        'BTC': 42100.00,\r\n        'USDC': 1.00\r\n    };\r\n\r\n    useEffect(() => {\r\n        fetchPortfolio();\r\n    }, []);\r\n\r\n    const fetchPortfolio = async () => {\r\n        try {\r\n            const res = await axios.get('http://localhost:5000/api/portfolio');\r\n            setPortfolio(res.data);\r\n            \r\n            // Calculate Total Value\r\n            let total = 0;\r\n            res.data.forEach(item => {\r\n                const currentPrice = marketPrices[item.symbol] || item.averageBuyPrice; // Fallback to buy price if live price not found\r\n                total += item.quantity * currentPrice;\r\n            });\r\n            setTotalValue(total);\r\n\r\n        } catch (err) {\r\n            console.error(\"Failed to fetch portfolio\", err);\r\n        }\r\n    };\r\n\r\n    const openModal = (symbol, price, type = 'buy') => {\r\n        setModalConfig({ isOpen: true, symbol, price, type });\r\n    };\r\n\r\n    const closeModal = () => {\r\n        setModalConfig(prev => ({ ...prev, isOpen: false }));\r\n    };\r\n\r\n  return (\r\n    <div className=\"space-y-6\">\r\n      <TransactionModal \r\n        isOpen={modalConfig.isOpen} \r\n        onClose={closeModal}\r\n        symbol={modalConfig.symbol}\r\n        currentPrice={modalConfig.price}\r\n        type={modalConfig.type}\r\n      />\r\n\r\n      {/* Welcome Section */}\r\n      <div className=\"flex justify-between items-end\">\r\n        <div>\r\n          <h1 className=\"text-3xl font-extrabold text-white\">Welcome back, Trader</h1>\r\n          <p className=\"text-slate-400 mt-1\">Here is what's happening in the market today.</p>\r\n        </div>\r\n        <button onClick={() => openModal('USDC', 1, 'buy')} className=\"flex items-center space-x-2 bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 rounded-lg font-medium transition-colors shadow-lg shadow-blue-600/20\">\r\n            <Plus size={18} />\r\n            <span>Deposit Funds</span>\r\n        </button>\r\n      </div>\r\n\r\n      {/* Main Grid */}\r\n      <div className=\"grid grid-cols-1 lg:grid-cols-3 gap-6\">\r\n        \r\n        {/* Left Column (Chart + Stats) */}\r\n        <div className=\"lg:col-span-2 space-y-6\">\r\n          <MarketChart />\r\n          \r\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\r\n             <div className=\"bg-slate-800 p-6 rounded-xl border border-slate-700\">\r\n                <p className=\"text-slate-400 text-sm font-medium\">Total Portfolio Value</p>\r\n                <p className=\"text-3xl font-bold text-white mt-2\">${totalValue.toLocaleString()}</p>\r\n                <div className=\"mt-4 flex items-center text-green-400 text-sm\">\r\n                    <span className=\"bg-green-400/10 px-2 py-1 rounded\">+12.5%</span> \r\n                    <span className=\"ml-2 text-slate-400\">vs invested capital</span>\r\n                </div>\r\n             </div>\r\n             <div className=\"bg-slate-800 p-6 rounded-xl border border-slate-700\">\r\n                <p className=\"text-slate-400 text-sm font-medium\">Your Holdings</p>\r\n                <div className=\"mt-2 space-y-2\">\r\n                    {portfolio.length === 0 ? (\r\n                        <p className=\"text-slate-500 text-sm\">No assets owned yet.</p>\r\n                    ) : (\r\n                        portfolio.map(asset => (\r\n                            <div key={asset._id} className=\"flex justify-between text-sm\">\r\n                                <span className=\"text-white font-medium\">{asset.symbol}</span>\r\n                                <span className=\"text-slate-400\">{asset.quantity} units</span>\r\n                            </div>\r\n                        ))\r\n                    )}\r\n                </div>\r\n             </div>\r\n          </div>\r\n        </div>\r\n\r\n        {/* Right Column (Watchlist/Assets) */}\r\n        <div className=\"space-y-4\">\r\n            <div className=\"flex justify-between items-center mb-2\">\r\n                <h3 className=\"text-xl font-bold text-white\">Market Watch</h3>\r\n                <button className=\"text-blue-500 text-sm font-medium hover:text-blue-400 transition-colors\">View All</button>\r\n            </div>\r\n            \r\n            {/* Mock Market Data Cards */}\r\n            <div onClick={() => openModal('AAPL', 175.43, 'buy')}><AssetCard symbol=\"AAPL\" name=\"Apple Inc.\" price={175.43} change={2.34} changePercent={1.25} isPositive={true} /></div>\r\n            <div onClick={() => openModal('TSLA', 240.50, 'buy')}><AssetCard symbol=\"TSLA\" name=\"Tesla, Inc.\" price={240.50} change={-5.20} changePercent={-2.15} isPositive={false} /></div>\r\n            <div onClick={() => openModal('BTC', 42100.00, 'buy')}><AssetCard symbol=\"BTC\" name=\"Bitcoin\" price={42100.00} change={1200.00} changePercent={3.45} isPositive={true} /></div>\r\n            \r\n            <div className=\"pt-4 border-t border-slate-800\">\r\n                 <h3 className=\"text-sm font-bold text-slate-400 mb-2\">ACTIONS</h3>\r\n                 <div className=\"grid grid-cols-2 gap-2\">\r\n                     <button onClick={() => openModal('AAPL', 175.43, 'sell')} className=\"bg-slate-800 text-slate-300 py-2 rounded hover:bg-slate-700 text-sm\">Sell AAPL</button>\r\n                     <button onClick={() => openModal('TSLA', 240.50, 'sell')} className=\"bg-slate-800 text-slate-300 py-2 rounded hover:bg-slate-700 text-sm\">Sell TSLA</button>\r\n                 </div>\r\n            </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Dashboard;\r\n```\r\n"],"mappings":"AAAA,EAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oEAAoEA,UAAU,CAACC,cAAc,CAAC,CAAC;AAC/F;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC,EAAE","ignoreList":[]},"metadata":{},"sourceType":"module"}